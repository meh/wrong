#include <wrong/mistake>

using namespace wrong;
using namespace wrong::action;

int
main ()
{
	mistake my;

	my.dependency("foo")
		.place(place::git()
			.remote("https://github.com/meh/wrong")
			.root("example/foo"))
		.provides<program>("foo",
			((sources({ "source/*.cpp" })
				>> compile().include("include").define("NO_MBEDTLS"))
			+(sources({ "source/mbedtls/*.c" })
				>> compile().include("include/mbedtls")))
			>> executable()
				.use("bar::bar")
				.link("m"));

	my.dependency("bar")
		.place(place::local()
			.path("example/bar"))
		.provides<library>("bar",
			   sources({ "library/*.cpp" })
			>> compile()
			>> archive());

//	my.program("bar")
//		// NOTE(meh): This adds a `prepare<provision>` to a list of required
//		//            provisions, which will then be built, it's essentially
//		//            a future.
//		.requires<program>("foo::foo");
//
//	return my.build("foo");
}
